##  简单网络管理协议SNMP
### 简单网络管理的基本概念

**网络管理包括对硬件，软件和人力的使用，综合与协调，以便对网络资源进行监视，测试，配置没分析，评价和控制。这样就能以合理的价格满足对网络的需求。网络管理通常称之为网管**。

网络管理模型中的主要构件(如图6-21)

![image](https://img2020.cnblogs.com/blog/2361214/202109/2361214-20210912120715803-1059613965.png)

1. **管理站**（管理器）：是整个网络管理系统的核心，由网络管理员直接操控。管理站所在的部门又称之为**网络运行中心NOC（Network Operations Center）**,管理站中的关键构件是**管理程序（图中的M）**。管理程序在运行时就成为**管理进程**。

2. 在被管网络中有很多的**被管设备**。被管设备有时候会被称之为**网络元素或者网元**。

3. 在每一个被管理的设备中都要运行一个程序以便和管理站中管理程序相互通信，这些程序称之为**网络管理代理程序**。简称为**代理(agent)**。如图中的A。

4. 还有一个重要构件就是**网络管理协议**，简称为**网管协议**。

**简单网络管理协议SNMP(Simple Network Management Protocol)**中的管理程序和代理程序采用的是**客户服务器**方式工作。管理程序运行**SNMP客户程序**，代理程序运行的是**SNMP服务器程序**，在被管理对象上SNMP服务器程序不停的监听来自管理站的SNMP客户程序的请求（命令），一旦发现，就立即返回管理站所需要的是信息，或者是执行某一个动作。

关于网络管理有一个基本原则就是：**若要管理某个对象，就必然会给该对象添加一些软件或硬件，但这种“添加”对原有对象的影响必须尽量小些**。

若网络元素使用的不是SNMP协议而是另一种网络管理协议，那么SNMP协议就无法控制该网络元素。这时可使用**委托代理(proxy agent)**。委托代理能提供如协议转换和过滤操作等功能对被管对象进行管理。

SNMP 的网络管理由三个部分组成，即 SNMP 本身、**管理信息结构 SMI (Structure of Management Information)**和**管理信息库 MIB（Management Information Base)**。下面简述这三部分的作用。

1. SNMP定义了管理站和代理之间所交换的分组格式。所交换的分组包含各代理中的对象出（变量）名及其状态（值）。SNMP 负责读取和修改这些数值。

### 2. 管理信息结构SMI

**管理信息结构 SMI** 是SNMP的重要组成部分。SMI的功能应当有3个:
* 被管理对象应该怎样命名;
* 用来存储被管理对象的数据结构有哪些;
* 在网络上管理的数据如何进行编码。

1. 被管理对象应该怎样命名
> SMI规定，所有的被管理对象都必须在**对象命名树(object naming tree)**上，图6-22给出了命名树的一部分。对象命名树的根没有名字，它的下面有三个顶级对象，都是世界上著名的标准制定单位，即 ITU-T（过去叫做 CCITT），ISO，以及这两个组织的联合体，它们的标号分别是0到2。图中的对象名习惯上用英文小写表示。在ISO的下面的一个标号为3 的节点是 ISO 认同的的组织成员 org。不在其下面有一个美国国防部 dod (Department of Defense)的子树（标号为6），再下面就是internet（标号为1）。在只讨论 internet 中的对象时，可只画出 internet 以下的子树，并在 internet 节点旁边写上对象标识符 1.3.6.1即可。在 internet 节点下面的标号为 2 的节点是 mgmt（管理）。再下面只有一个节点，即管理信息库 mib-2，其对象标识符为 1.3.6.1.2.1。在 mib-2 下面包含了所有被 SNMP 管理的对象
![image](https://img2022.cnblogs.com/blog/2361214/202202/2361214-20220222000956033-490476903.png)

>

2. 被管对象的数据类型
> SMI 使用基本的**抽象语法记法1**（即 ISO 制定的 ASN.1®）来定义数据类型，但又增加了一些新的定义。因此SMI既是ASN.1的子集，又是ASN.1的超集。ASN.1的记法很严格，它使得数据的含义不存在任何可能的二义性。例如，使用 ASN.1 时不能简单地说“个具有整数值的变量”，而必须说明该变量的准确格式和整数取值的范围。当网络中的计算机对数据项并不都使用相同的表示时，采用这种精确的记法就尤其重要.
我们知道，任何数据都具有两种重要的属性，即**值(value)与类型(type)**。这里“值”是某个值集合中的一个元素，而“类型”则是值集合的名字。如果给定一种类型，则这种类型的一个值就是该类型的一个具体实例。
SMI 把数据类型分为两大类：**简单类型**和**结构化类型**。简单类型是最基本的、直接使用ASN.1定义的类型。表6-4给出了最主要的几种简单类型。表6-4给出了最主要的几种简单类型。
![image](https://img2022.cnblogs.com/blog/2361214/202202/2361214-20220222001021145-220277888.png)

>       

3. 编码方法
> SMI 使用ASN.1制定的基本编码规则 BER (Basic Encoding Rule)进行数据的编码。BER指明了每种数据的类型和值。在发送端用BER编码，可把用ASN.1所表述的报文转换成唯一的比特序列。在接收端用BER进行解码，就可得到该比特序列所表示的ASN.1报文。
>     

### 管理信息库
所谓**管理信息**就是指在互联网的网管框架中**被管对象的集合**。被管对象必须维持可供管理程序读写的若干控制和状态信息。这些被管对象构成了一个虚拟的信息存储器，所以才称为**管理信息库 MIB**。管理程序就使用 MIB 中这些信息的**值**对网络进行管理（如读取或重新设置这些值）。只有在 MIB 中的对象才是 SNMP 所能够管理的。例如，路由器应当维持各网络接口的状态、入分组和出分组的流量、丢弃的分组和有差错的报文的统计信息，而调制解调器则应当维持发送和接收的字符数、码元传输速率和接受的呼叫等统计信息。因此在MIB中就必须有上面这样一些信息。

实际上，SNMP的操作只有两种基本的管理功能，即:
1. **读**操作，用Get报文来检测各被管理对象的信息。
2. **写操作**，用Set报文来修改被各管理对象的信息。